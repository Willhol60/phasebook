<div class='container'>
  <h1>My Reads</h1>


  <div class="my-flipster">
    <ul>
    <% current_user.readings.where('read_status = ?', 'Current').reverse.each do |reading| %>
      <li data-flip-category="<%= reading.read_status %>" class='flip-current'>
        <div class='bookmark b-current'>
          <i class="fas fa-bookmark"></i>
        </div>
        <%= image_tag reading.book.poster_url, style:"width: 250px; height: 100%; object-fit: contain;" %>
        <%= link_to "Finish Reading", "#", class: "read-button current"  %>
      </li>
    <% end %>
    <% current_user.readings.where('read_status = ?', 'Future').reverse.each do |reading| %>
      <li data-flip-category="<%= reading.read_status %>" class='flip-future'>
        <div class='bookmark b-future'>
          <i class="fas fa-bookmark"></i>
        </div>
        <%= image_tag reading.book.poster_url, style:"width: 250px; height: 100%; object-fit: contain;" %>
        <%= link_to "Start Reading", "#", class: "read-button future"  %>
      </li>
    <% end %>
    </ul>
  </div>


  <%= form_tag search_books_path, method: :get do |form| %>
    <%= text_field_tag :query,
      params[:query],
      class: "form-control",
      placeholder: "Find a book by title, ISBN, author, or category"
    %>
    <%= submit_tag "Search", class: "btn btn-primary mb-2 mt-2" %>
  <% end %>
  <%= link_to "Random!", random_books_path, class: 'btn btn-success mb-2' %>
  <div class="d-flex flex-wrap justify-content-center align-items-center p-2">
    <%# Copied from readings index: %>
    <% current_user.readings.where('read_status = ?', 'Finished').reverse.each do |reading| %>
    <%# CARD: %>
      <div class="library-card" >
        <div data-controller="library-card" class="m-3">
          <div data-action="mouseenter->library-card#changeCard mouseleave->library-card#changeCardBack">
            <div data-library-card-target="cover" >
              <%= image_tag reading.book.poster_url, style:"width: 280px; height: 400px; object-fit: contain" %>
            </div>
            <div class="d-none" data-library-card-target="info" style="width: 300px; height: 420px; margin-top: -20px" >
              <div style="color: white; background-image: linear-gradient( rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7) ), url('<%=reading.book.poster_url%>');
                          background-size: cover; padding: 12px ">
                <div class="d-flex flex-column">
                  <div class="d-flex justify-content-end p-2">
                    <%= link_to book_path(reading.book), method: :delete, remote: true do %>
                      <i class="fa fa-trash" aria-hidden="true" style="color:white"></i>
                    <% end %>
                  </div>
                  <div id="card-info">
                    <h4 style='color: white'><%= reading.book.title %></h4>
                    <p><%= reading.book.author %></p>
                    <p>Rated: <%= reading.user_rating %></p>
                  </div>
                </div>
                <div class='row'>
                  <p>Reading status: <%= reading.read_status %></p>
                </div>
                <br>
                <%= link_to "Delete", book_path(reading.book), method: :delete, class: "btn btn-danger"  %>
              </div>
            </div>
          </div>
        </div>
      </div>

    <% end %>
  </div>
  <%# <% if reading.end_date && reading.start_date %>
    <%# <p>days to read:<%= (reading.end_date - reading.start_date).to_i %>
  <%# <% end %>
</div>
